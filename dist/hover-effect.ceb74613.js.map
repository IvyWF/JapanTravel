{"version":3,"sources":["scripts/hover-effect.js"],"names":["hoverEffect","opts","THREE","window","vertex","fragment","firstDefined","i","arguments","length","undefined","parent","dispImage","displacementImage","image1","image2","intensity1","intensity","intensity2","commonAngle","angle","Math","PI","angle1","angle2","speedIn","speed","speedOut","userHover","hover","easing","Expo","easeOut","console","warn","scene","Scene","camera","OrthographicCamera","offsetWidth","offsetHeight","position","z","renderer","WebGLRenderer","antialias","setPixelRatio","devicePixelRatio","setClearColor","setSize","appendChild","domElement","render","loader","TextureLoader","crossOrigin","texture1","load","texture2","disp","wrapS","wrapT","RepeatWrapping","magFilter","LinearFilter","minFilter","mat","ShaderMaterial","uniforms","type","value","dispFactor","vertexShader","fragmentShader","transparent","opacity","geometry","PlaneBufferGeometry","object","Mesh","add","transitionIn","TweenMax","to","ease","onUpdate","onComplete","transitionOut","addEventListener","e","next","previous"],"mappings":"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","file":"hover-effect.ceb74613.js","sourceRoot":"..","sourcesContent":["var hoverEffect = function (opts) {\n    var THREE = window.THREE;\n    var vertex = `\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  }\n  `;\n\n    var fragment = `\n  varying vec2 vUv;\n  \n  uniform float dispFactor;\n  uniform sampler2D disp;\n  \n  uniform sampler2D texture1;\n  uniform sampler2D texture2;\n  uniform float angle1;\n  uniform float angle2;\n  uniform float intensity1;\n  uniform float intensity2;\n  \n  mat2 getRotM(float angle) {\n    float s = sin(angle);\n    float c = cos(angle);\n    return mat2(c, -s, s, c);\n  }\n  \n  void main() {\n    vec4 disp = texture2D(disp, vUv);\n    vec2 dispVec = vec2(disp.r, disp.g);\n    vec2 distortedPosition1 = vUv + getRotM(angle1) * dispVec * intensity1 * dispFactor;\n    vec2 distortedPosition2 = vUv + getRotM(angle2) * dispVec * intensity2 * (1.0 - dispFactor);\n    vec4 _texture1 = texture2D(texture1, distortedPosition1);\n    vec4 _texture2 = texture2D(texture2, distortedPosition2);\n    gl_FragColor = mix(_texture1, _texture2, dispFactor);\n  }\n  `;\n\n    function firstDefined() {\n        for (var i = 0; i < arguments.length; i++) {\n            if (arguments[i] !== undefined) return arguments[i];\n        }\n    }\n\n    var parent = opts.parent;\n    var dispImage = opts.displacementImage;\n    var image1 = opts.image1;\n    var image2 = opts.image2;\n    var intensity1 = firstDefined(opts.intensity1, opts.intensity, 1);\n    var intensity2 = firstDefined(opts.intensity2, opts.intensity, 1);\n    var commonAngle = firstDefined(opts.angle, Math.PI / 4); // 45 degrees by default, so grayscale images work correctly\n    var angle1 = firstDefined(opts.angle1, commonAngle);\n    var angle2 = firstDefined(opts.angle2, -commonAngle * 3);\n    var speedIn = firstDefined(opts.speedIn, opts.speed, 1.6);\n    var speedOut = firstDefined(opts.speedOut, opts.speed, 1.2);\n    var userHover = firstDefined(opts.hover, true);\n    var easing = firstDefined(opts.easing, Expo.easeOut);\n\n    if (!parent) {\n        console.warn('Parent missing');\n        return;\n    }\n\n    if (!(image1 && image2 && dispImage)) {\n        console.warn('One or more images are missing');\n        return;\n    }\n\n    var scene = new THREE.Scene();\n    var camera = new THREE.OrthographicCamera(\n        parent.offsetWidth / -2,\n        parent.offsetWidth / 2,\n        parent.offsetHeight / 2,\n        parent.offsetHeight / -2,\n        1,\n        1000\n    );\n\n    camera.position.z = 1;\n\n    var renderer = new THREE.WebGLRenderer({ antialias: false });\n\n    renderer.setPixelRatio(window.devicePixelRatio);\n    renderer.setClearColor(0xffffff, 0.0);\n    renderer.setSize(parent.offsetWidth, parent.offsetHeight);\n    parent.appendChild(renderer.domElement);\n\n    var render = function () {\n        // This will be called by the TextureLoader as well as TweenMax.\n        renderer.render(scene, camera);\n    };\n\n    var loader = new THREE.TextureLoader();\n    loader.crossOrigin = '';\n    var texture1 = loader.load(image1, render);\n    var texture2 = loader.load(image2, render);\n    var disp = loader.load(dispImage, render);\n    disp.wrapS = disp.wrapT = THREE.RepeatWrapping;\n\n    texture1.magFilter = texture2.magFilter = THREE.LinearFilter;\n    texture1.minFilter = texture2.minFilter = THREE.LinearFilter;\n\n    var mat = new THREE.ShaderMaterial({\n        uniforms: {\n            intensity1: { type: 'f', value: intensity1 },\n            intensity2: { type: 'f', value: intensity2 },\n            dispFactor: { type: 'f', value: 0.0 },\n            angle1: { type: 'f', value: angle1 },\n            angle2: { type: 'f', value: angle2 },\n            texture1: { type: 't', value: texture1 },\n            texture2: { type: 't', value: texture2 },\n            disp: { type: 't', value: disp },\n        },\n\n        vertexShader: vertex,\n        fragmentShader: fragment,\n        transparent: true,\n        opacity: 1.0,\n    });\n\n    var geometry = new THREE.PlaneBufferGeometry(parent.offsetWidth, parent.offsetHeight, 1);\n    var object = new THREE.Mesh(geometry, mat);\n    scene.add(object);\n\n    function transitionIn() {\n        TweenMax.to(mat.uniforms.dispFactor, speedIn, {\n            value: 1,\n            ease: easing,\n            onUpdate: render,\n            onComplete: render,\n        });\n    }\n\n    function transitionOut() {\n        TweenMax.to(mat.uniforms.dispFactor, speedOut, {\n            value: 0,\n            ease: easing,\n            onUpdate: render,\n            onComplete: render,\n        });\n    }\n\n    if (userHover) {\n        parent.addEventListener('mouseenter', transitionIn);\n        parent.addEventListener('touchstart', transitionIn);\n        parent.addEventListener('mouseleave', transitionOut);\n        parent.addEventListener('touchend', transitionOut);\n    }\n\n    window.addEventListener('resize', function (e) {\n        renderer.setSize(parent.offsetWidth, parent.offsetHeight);\n    });\n\n    this.next = transitionIn;\n    this.previous = transitionOut;\n};"]}